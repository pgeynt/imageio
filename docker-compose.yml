services:
  web:
    image: php:8.2-apache
    entrypoint: ["bash", "/var/www/html/entrypoint.sh"]
    volumes:
      - .:/var/www/html
      - storage_data:/var/www/html/storage
      - pg_data:/var/lib/postgresql/15/main
    environment:
      POSTGRES_HOST: localhost
      POSTGRES_DB: ${POSTGRES_DB:-imageio}
      POSTGRES_USER: ${POSTGRES_USER:-imageio}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-imageio_secret_change_me}
      APP_URL: ${APP_URL}
    networks:
      - dokploy-network
    restart: unless-stopped

networks:
  dokploy-network:
    external: true

volumes:
  storage_data:
  pg_data:
